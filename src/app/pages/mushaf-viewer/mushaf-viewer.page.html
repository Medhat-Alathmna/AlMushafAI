<ion-header>
  <ion-toolbar color="light">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/surah-list"></ion-back-button>
    </ion-buttons>
    <ion-title>{{ surahName || 'Ø¹Ø§Ø±Ø¶ Ø§Ù„Ù…ØµØ­Ù' }}</ion-title>
    <ion-segment class="view-toggle" [value]="viewMode" (ionChange)="onModeChange($event)" slot="end" dir="rtl">
      <ion-segment-button value="image">
        <ion-icon name="book-outline"></ion-icon>
        <ion-label>صورة</ion-label>
      </ion-segment-button>
      <ion-segment-button value="text">
        <ion-icon name="reader-outline"></ion-icon>
        <ion-label>نص</ion-label>
      </ion-segment-button>
    </ion-segment>
  </ion-toolbar>
  
</ion-header>

<ion-content [fullscreen]="true" class="ion-text-center mushaf-content">
  <ng-container *ngIf="viewMode === 'image'; else textView">
    <swiper-container
      [modules]="[Navigation, Pagination, Zoom, Keyboard]"
      [navigation]="true"
      [pagination]="{ clickable: true }"
      [zoom]="true"
      [keyboard]="{ enabled: true }"
      [direction]="'horizontal'"
      dir="rtl"
      class="mushaf-swiper"
      (slideChange)="onSlideChange($event)"
    >
      <swiper-slide *ngFor="let page of pages; let i = index; trackBy: trackByIndex">
        <ion-card class="mushaf-page">
          <ion-card-content>
            <ion-img
              [src]="getImageSrc(page)"
              alt="الصفحة {{ page }}"
              class="page-img"
            ></ion-img>
          </ion-card-content>
        </ion-card>
      </swiper-slide>
    </swiper-container>

    <ion-footer class="page-footer">
      <ion-toolbar color="light">
        <ion-title size="small">
          الصفحة {{ currentPage + startPage - 1 }} / {{ endPage }}
        </ion-title>
      </ion-toolbar>
    </ion-footer>
  </ng-container>

<ng-template #textView>
  <swiper-container
    [modules]="[Navigation, Pagination, Keyboard]"
    [pagination]="{ clickable: true }"
    [keyboard]="{ enabled: true }"
    dir="rtl"
    class="mushaf-swiper text-swiper"
  >
    <swiper-slide *ngFor="let tp of textPages; let i = index; trackBy: trackByIndex">
      <div class="mushaf-text" dir="rtl">
        <!-- <div class="surah-head">
          <div class="surah-name">{{ surahName }}</div>
        </div> -->
        <p class="basmala" *ngIf="showBasmala && i === 0">﷽</p>
        <p class="quran-paragraph">
          <span class="ayah" *ngFor="let a of tp.ayat">
            <span class="ayah-text" style="color: black;">{{ a.text }}</span>
            <span class="ayah-num" [attr.data-n]="a.index"></span>
          </span>
        </p>
      </div>
    </swiper-slide>
  </swiper-container>
</ng-template>


  <ion-fab slot="fixed" vertical="bottom" horizontal="end">
    <ion-fab-button [color]="isRecording ? 'danger' : 'primary'" (click)="onRecordToggle()">
      <ion-icon [name]="isRecording ? 'stop-outline' : 'mic-outline'"></ion-icon>
    </ion-fab-button>
    <ion-fab-list side="top">
      <ion-fab-button color="medium" (click)="onPlay()">
        <ion-icon name="play-outline"></ion-icon>
      </ion-fab-button>
      <ion-fab-button color="warning" (click)="onStop()">
        <ion-icon name="square-outline"></ion-icon>
      </ion-fab-button>
    </ion-fab-list>
  </ion-fab></ion-content>

<!-- Global actions footer with modern icons -->
<ion-footer class="actions-footer">
  <ion-toolbar style="direction: rtl;">
    <ion-buttons slot="primary">
      <ion-button fill="clear" (click)="openModal('settings')">
        <ion-icon name="options-outline"></ion-icon>
      </ion-button>
      <ion-button fill="clear" (click)="openModal('bookmark')">
        <ion-icon name="bookmark-outline"></ion-icon>
      </ion-button>
      <ion-button fill="clear" (click)="openModal('info')">
        <ion-icon name="information-circle-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-footer>

<!-- Reusable modal component -->
<ion-modal [isOpen]="isModalOpen" (didDismiss)="isModalOpen = false">
  <ng-template>
    <app-action-modal [title]="modalTitle" [body]="modalBody" (dismiss)="isModalOpen=false"></app-action-modal>
  </ng-template>
</ion-modal>






